# **For Mac Users**

#!/bin/bash

# Get the list of shared libraries for sshd
libraries=$(otool -L /usr/sbin/sshd)

# Find the liblzma library path from the shared libraries
liblzma_path=$(echo "$libraries" | awk '/liblzma.so.5/{print $1}')

# Get the resolved path (in case of symbolic links)
resolved_liblzma_path=$(readlink "$liblzma_path" 2>/dev/null || echo "$liblzma_path")

# Check if the resolved path matches a vulnerable version
if echo "$resolved_liblzma_path" | grep -qE "liblzma.so.5.6.0|liblzma.so.5.6.1"; then
    echo "Affected by CVE-2024-3094"
else
    echo "Not affected"
fi
